---
phase: 07-cross-platform
plan: 01
type: execute
---

<objective>
Ensure the tool works reliably on macOS, Windows, and Linux.

Purpose: Detect platform-specific paths and verify required dependencies are available.
Output: Cross-platform compatibility with clear dependency guidance.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Depends on:** Phase 4 (DOCX Converter) â€” LibreOffice detection

**Platform considerations:**
- macOS: LibreOffice in /Applications, Chromium bundled with Puppeteer
- Linux: LibreOffice via package manager, may need additional deps
- Windows: LibreOffice in Program Files, path separators differ
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement platform detection and path resolution</name>
  <files>src/utils/platform.ts</files>
  <action>
    Create platform utilities:

    ```typescript
    export type Platform = 'darwin' | 'linux' | 'win32';

    export function getPlatform(): Platform {
      return process.platform as Platform;
    }

    export function isWindows(): boolean {
      return process.platform === 'win32';
    }

    export function isMacOS(): boolean {
      return process.platform === 'darwin';
    }

    export function isLinux(): boolean {
      return process.platform === 'linux';
    }

    // Path normalization for cross-platform
    export function normalizePath(p: string): string {
      return path.normalize(p);
    }
    ```

    Handle Windows path separators and drive letters.
  </action>
  <verify>Platform detected correctly on current system</verify>
  <done>Platform utilities work across all systems</done>
</task>

<task type="auto">
  <name>Task 2: Implement dependency verification command</name>
  <files>src/cli.ts, src/utils/dependencies.ts</files>
  <action>
    Add `--check-deps` command:

    ```typescript
    // src/utils/dependencies.ts
    interface DependencyStatus {
      name: string;
      required: boolean;
      found: boolean;
      path?: string;
      version?: string;
      installHint?: string;
    }

    async function checkDependencies(): Promise<DependencyStatus[]> {
      return [
        await checkChromium(),
        await checkLibreOffice(),
      ];
    }

    async function checkChromium(): Promise<DependencyStatus> {
      // Puppeteer bundles Chromium, but check it's accessible
      // Return status with version if found
    }

    async function checkLibreOffice(): Promise<DependencyStatus> {
      const path = await findSoffice();
      return {
        name: 'LibreOffice',
        required: true,  // for DOCX
        found: path !== null,
        path: path || undefined,
        installHint: getLibreOfficeInstallHint(),
      };
    }

    function getLibreOfficeInstallHint(): string {
      switch (getPlatform()) {
        case 'darwin':
          return 'brew install --cask libreoffice';
        case 'linux':
          return 'sudo apt install libreoffice (Debian/Ubuntu)';
        case 'win32':
          return 'Download from https://www.libreoffice.org/download/';
      }
    }
    ```

    Add to CLI:
    ```typescript
    program
      .command('check')
      .description('Check system dependencies')
      .action(async () => {
        const deps = await checkDependencies();
        // Display formatted status
      });
    ```
  </action>
  <verify>`node dist/cli.js check` shows dependency status</verify>
  <done>Users can verify their system is ready</done>
</task>

<task type="auto">
  <name>Task 3: Add platform-specific installation guidance</name>
  <files>src/utils/dependencies.ts</files>
  <action>
    Enhance error messages with platform-specific install commands:

    ```typescript
    function getInstallInstructions(dep: string): string {
      const platform = getPlatform();

      const instructions: Record<string, Record<Platform, string>> = {
        libreoffice: {
          darwin: `
    Install LibreOffice:
      brew install --cask libreoffice

    Or download from:
      https://www.libreoffice.org/download/`,
          linux: `
    Install LibreOffice:
      Ubuntu/Debian: sudo apt install libreoffice
      Fedora: sudo dnf install libreoffice
      Arch: sudo pacman -S libreoffice`,
          win32: `
    Install LibreOffice:
      Download from https://www.libreoffice.org/download/
      Or: winget install LibreOffice.LibreOffice`,
        },
      };

      return instructions[dep]?.[platform] || 'Please install the required dependency.';
    }
    ```

    Show these instructions when dependency check fails.
  </action>
  <verify>Missing dependency shows platform-appropriate install command</verify>
  <done>Users get actionable install instructions for their OS</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `node dist/cli.js check` works
- [ ] LibreOffice detected if installed
- [ ] Missing deps show platform-specific install hints
- [ ] Paths work on current platform
</verification>

<success_criteria>

- All tasks completed
- Cross-platform path handling works
- Users can diagnose and fix dependency issues
</success_criteria>

<output>
After completion, create `.planning/phases/07-cross-platform/07-01-SUMMARY.md`
</output>
