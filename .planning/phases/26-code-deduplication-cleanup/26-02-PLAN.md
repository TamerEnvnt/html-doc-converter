---
phase: 26-code-deduplication-cleanup
plan: 02
type: execute
---

<objective>
Remove 16 unused exported functions across 3 utility files and their corresponding tests. Clean up unused variable in CLI.

Purpose: Dead code increases cognitive load, inflates coverage reports, and creates maintenance burden. These 16 functions are thin wrappers around Node.js builtins that were never consumed by any production code.
Output: Leaner utility modules. Tests accurately reflect used code. Coverage numbers reflect real codebase.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/26-code-deduplication-cleanup/26-01-SUMMARY.md

# Source files to modify:
@src/utils/platform.ts
@src/utils/logger.ts
@src/utils/output-handler.ts
@src/cli.ts

# Test files to modify:
@tests/utils/platform.test.ts
@tests/utils/logger.test.ts
@tests/utils/output-handler.test.ts

**Established patterns:**
- Named exports in index.ts over export * [Phase 19]
- No unused exports in public API — index.ts curates what's public

**Key verification:**
- None of these 16 functions appear in index.ts (public API). They are internal-only and unused.
- getPlatform and getPlatformName ARE used (by soffice.ts and dependencies.ts) — KEEP them.
- setVerbose and verbose ARE used (by cli.ts and platform.ts) — KEEP them.
- validatePath, resolveOutputPaths, ensureOutputDirectory ARE used (by cli.ts) — KEEP them.

**Functions to remove (verified unused by grep across src/):**

platform.ts (8 functions):
- isWindows() — `process.platform === 'win32'` used directly where needed
- isMacOS() — `process.platform === 'darwin'` used directly where needed
- isLinux() — `process.platform === 'linux'` used directly where needed
- normalizePath() — `path.normalize()` used directly
- toForwardSlashes() — never called
- getPathSeparator() — `path.sep` used directly
- joinPaths() — `path.join()` used directly
- resolvePath() — `path.resolve()` used directly

logger.ts (6 functions):
- isVerbose() — never called (setVerbose checks internally)
- info() — `console.log()` used directly
- error() — `console.error()` used directly
- warn() — never called
- success() — never called
- debug() — never called

output-handler.ts (2 functions):
- generateUniqueFilename() — never called (overwrite protection uses --force flag instead)
- fileExists() — never called (`existsSync` or `fs.access` used directly)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove 8 unused functions from platform.ts and update tests</name>
  <files>src/utils/platform.ts, tests/utils/platform.test.ts</files>
  <action>
In platform.ts, remove these 8 functions entirely (including their JSDoc comments and any section headers that become empty):

1. `isWindows()` (lines 35-37)
2. `isMacOS()` (lines 42-44)
3. `isLinux()` (lines 49-51)
4. `normalizePath()` (lines 61-63)
5. `toForwardSlashes()` (lines 68-70)
6. `getPathSeparator()` (lines 75-77)
7. `joinPaths()` (lines 82-84)
8. `resolvePath()` (lines 89-91)

Also remove the "Path Utilities" section header (line 53-56) since all path utilities are being removed.

Keep:
- `Platform` type (used by dependencies.ts)
- `getPlatform()` (used by soffice.ts)
- `getPlatformName()` (used by dependencies.ts)
- The `import * as path from 'path'` can be removed if getPlatformName doesn't use it (check: it doesn't — it only uses process.platform). Same for the `import { verbose }` — keep it (used by getPlatform).

After removals, platform.ts should have: Platform type, getPlatform(), getPlatformName(). That's it.

In tests/utils/platform.test.ts, remove:
- The import of removed functions (isWindows, isMacOS, isLinux, normalizePath, toForwardSlashes, getPathSeparator, joinPaths, resolvePath)
- All test blocks for removed functions:
  - "OS check helpers" describe block (isWindows, isMacOS, isLinux tests)
  - "Path utilities" describe block (normalizePath, toForwardSlashes, getPathSeparator, joinPaths, resolvePath tests)
- Keep: getPlatform tests, getPlatformName tests, and any unknown platform fallback test

Verify test file still imports what it needs and all remaining tests pass.
  </action>
  <verify>npx vitest run tests/utils/platform.test.ts --reporter=verbose passes</verify>
  <done>platform.ts reduced from ~111 lines to ~35 lines. 8 unused functions removed. Corresponding tests removed. Remaining tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Remove 8 unused functions from logger.ts and output-handler.ts, update tests, clean up cli.ts</name>
  <files>src/utils/logger.ts, src/utils/output-handler.ts, src/cli.ts, tests/utils/logger.test.ts, tests/utils/output-handler.test.ts</files>
  <action>
**logger.ts — Remove 6 functions:**

1. `isVerbose()` (lines 29-31)
2. `info()` (lines 49-51)
3. `error()` (lines 56-58)
4. `warn()` (lines 63-65)
5. `success()` (lines 70-72)
6. `debug()` (lines 77-82)

Keep: `setVerbose()`, `verbose()` (both actively used).

After removals, logger.ts should have: verboseMode state, setVerbose(), verbose(). That's it.

**output-handler.ts — Remove 2 functions:**

1. `generateUniqueFilename()` (lines 99-120)
2. `fileExists()` (lines 125-127)

Also remove the `import { existsSync } from 'fs';` (line 9) since both functions using it are removed. Check that no remaining function uses existsSync (ensureOutputDirectory uses `fs.mkdir` from fs/promises, not existsSync).

Keep: validatePath(), OutputPaths type, resolveOutputPaths(), ensureOutputDirectory() (all used by cli.ts).

**tests/utils/logger.test.ts — Remove test blocks:**

- Remove imports of: isVerbose, info, error (the console.error one), warn, success, debug
- Remove describe blocks for: 'setVerbose / isVerbose' (but KEEP the setVerbose tests within it — restructure as 'setVerbose'), 'info', 'warn', 'success', 'debug'
- Actually: the 'setVerbose / isVerbose' describe has tests for both. Remove isVerbose-specific tests, keep setVerbose tests. If the describe only tests isVerbose behavior (reading state), and setVerbose is tested implicitly through verbose() tests, then remove the whole block. Read the file carefully to decide.

**tests/utils/output-handler.test.ts — Remove test blocks:**

- Remove imports of: generateUniqueFilename, fileExists
- Remove describe blocks for: 'generateUniqueFilename', 'fileExists'
- Keep: validatePath, resolveOutputPaths, ensureOutputDirectory tests

**cli.ts — Drop unused variable:**

Line 88: Change `const { fileSize, content, isLargeFile } = await validateInputFile(inputPath);` to `const { fileSize, isLargeFile } = await validateInputFile(inputPath);`

The `content` variable is destructured but never used after this line. The file content is re-read by Puppeteer/LibreOffice converters. Dropping it documents the intent — validateInputFile validates the file, cli.ts only needs the metadata.

Note: Do NOT change validateInputFile itself — it still returns content (needed for empty-file validation internally). Only the cli.ts destructuring changes.
  </action>
  <verify>npx vitest run tests/utils/logger.test.ts tests/utils/output-handler.test.ts tests/cli.test.ts --reporter=verbose passes</verify>
  <done>logger.ts reduced by 6 functions. output-handler.ts reduced by 2 functions. cli.ts drops unused content variable. Corresponding tests removed. All remaining tests pass.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx vitest run` - all tests pass
- [ ] `npx tsc --noEmit` - no TypeScript errors
- [ ] Coverage thresholds maintained (may increase since dead code removed)
- [ ] platform.ts: only Platform type, getPlatform(), getPlatformName() remain
- [ ] logger.ts: only setVerbose(), verbose() remain (plus verboseMode state)
- [ ] output-handler.ts: only validatePath(), OutputPaths, resolveOutputPaths(), ensureOutputDirectory() remain
- [ ] cli.ts: `content` not destructured from validateInputFile
- [ ] No public API changes (none of the removed functions were in index.ts)
- [ ] Phase 26 complete (both plans done)
</verification>

<success_criteria>

- 16 unused functions removed from production code
- Corresponding tests removed (no dead test code)
- All remaining tests pass
- Coverage thresholds met (likely improved)
- No TypeScript errors
- Phase 26 fully complete
</success_criteria>

<output>
After completion, create `.planning/phases/26-code-deduplication-cleanup/26-02-SUMMARY.md`
</output>
